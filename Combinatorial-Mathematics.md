# 组合学
---
## 排列&组合
### 基本概念
1. 加法原理
	设集合$S$划分为部分$S_1,S_2,\cdots,S_m$，则$S$的元素的个数可以通过找出它的每一部分的元素的个数来确定，把这些数相加，得到：$$|S|=|S_1|+|S_2|+\cdots+|S_m|$$
2. 乘法原理
	令$S$是元素的序偶$(a,b)$的集合，其中第一个元素$a$来自大小为$p$的一个集合，而对于$a$的每个选择，元素$b$存在着$q$种选择，于是：$$|S|=p\times q$$
3. $n$个元素中的$r$个有序摆放称为$n$个元素的集合$S$的一个$r-$排序。$n$个元素集合的$r-$排列的数目用$P(n,r)$来表示

4. $n$个元素中的$r$个无序选择称为$n$个元素的集合$S$的一个$r-$组合。$n$个元素集合的$r-$组合的数目用${n\choose r}$或$C(n,r)$来表示

5. 如果$S$是一个多重集，那么$S$的一个$r-$排列是$S$的$r$个元素的一个有序排放。如果$S$的元素总个数是$n$，那么$S$的$n-$排列也将成为$S$的排列
---
### 性质
1. 对于正整数$n$和$r$，$r\le n$，有$$P(n,r)=n(n-1)(n-2)\cdots (n-r+1)=\frac{n!}{(n-r)!}$$

2. $n$个元素的集合的循环$r-$排列的个数由$$\frac{P(n,r)}{r}=\frac{n!}{r(n-r)!}$$
3. 对于$0\le r\le n$,$$P(n,r)=r!{n\choose r}$$因此$${n \choose r}=\frac{n!}{r!(n-r)!}$$
4. 令$S$是一个多重集，它有$k$个不同类型的元素，每个元素，每个元素都有无穷重复个数，那么$S$的$r-$排列的个数为$k^r$
5. 令$S$是一个多重集，有$k$个不同类型的元素，各元素的重数分别为$n_1,n_2,n_3,\cdots,n_k$，设$S$的大小为$n=n_1+n_2+\cdots+n_k$，则$S$的排列数等于$$\frac{n!}{n_1!n_2!\cdots n_k!}$$
---
## 鸽巢原理
### 基本概念
令$q_1,q_2,\cdots,q_n$为正整数，如果将4$$q_1+q_2+\cdots+q_n-n+1$$个物体放入$n$个盒子内，那么第$k$个盒子至少含有$q_k$个物体
### 性质
1. 如果将$n$个物体放入$n$个盒子并且没有一个盒子是空的，那么每个盒子恰好包含一个物体
2. 如果将$n$个物体放入$n$个盒子并且没有盒子被放入多于一个的物体，那么每个盒子里有一个物体
3. 如果$n$个非负整数$m_1,m_2,\cdots,m_n$的平均数大于$r-1$：$\frac{m_1+m_2+\cdots+m_n}{n}>r-1$那么至少有一个整数大于或等于$r$
---
## 容斥原理
### 基本概念
1. 容斥原理
	集合$S$不具有性质$P_1,P_2,\cdots,P_m$的物体的个数由下式给出：
$$
\begin{equation}
\begin{split}
\mid \bar{A_1}\cap\bar{A_2}\cap\cdots \cap\bar{A_m}\mid=\mid S\mid-\sum_{i=1}^{m}\mid A_i\mid+\sum_{i,j:i<j}\mid \bar{A_i}\cap\bar{A_j}\mid-\sum_{i,j,k:i<j<k}\mid \bar{A_i}\cap\bar{A_j}\cap\bar{A_k}\mid \\ +\cdots +(-1)^{m}\mid \bar{A_1}\cap\bar{A_2}\cap\cdots\cap\bar{A_m}\mid 
\end{split}
\end{equation}
$$
其中$A_i$表示$S$中具有性质$P_i$的集合，$\bar{A_i}$表示$A_i$在集合$S$中的补集
2. 推论
	至少具有性质$P_1,P_2,\cdots,P_m$之一的集合的物体的个数由下列公式给出$$
\begin{equation}
\begin{split}
\mid A_1\cup A_2\cup\cdots \cup A_m\mid=\sum_{i=1}^{m}\mid A_i\mid-\sum_{i,j:i<j}\mid A_i\cap A_j\mid+sum_{i,j,k:i< j< k}\mid A_i\cap A_j\cap A_k\mid \\ +\cdots +(-1)^{m+1}\mid A_1\cap A_2\cap\cdots\cap A_m\mid 
\end{split}
\end{equation}
$$
3. 设集合$S$中满足性质$P$,$Q$的集合分别为$A$,$B$，满足性质$P$或$Q$的物体个数为：$$\mid A\cup B\mid+\mid A\mid+\mid B\mid-\mid A\cap B\mid$$
---
### 性质
**错位排序**
一个$\left\{1,2,3,\cdots,n\right\}$的全排列$P$称为错位排列,指对一切$i\in \left\{1,2,\cdots,n\right\},p_i\ne i$(换句话说,$\left\{1,2,\cdots,n\right\}$的全排列中每个元素不在各自位置上的排列称为错位排列)
假设对$\left\{1,2,\cdots,n\right\}$:
用$D_n$表示错位排列的个数，用$S_n$表示全排列，用$A_i$表示数字$i$在第$i$位的全排列，$\mid A_i\mid=(n+1)!$

由容斥原理知：
$$
\begin{equation}
\begin{split}
D_n&=\mid\bar{A_1}\cap\bar{A_2}\cap\cdots\cap\bar{A_n}\mid
\\&=\mid S\mid-\sum_{i=1}^{n}-\mid A_i\mid+\sum_{i,j:i<j}\mid \bar{A_i}\cap\bar{A_j}\mid-\sum_{i,j,k:i<j<k}\mid \bar{A_i}\cap\bar{A_j}\cap\bar{A_k}\mid \\&\quad +\cdots +(-1)^{m}\mid \bar{A_1}\cap\bar{A_2}\cap\cdots\cap\bar{A_m}\mid 
\end{split}
\end{equation}
$$
上式等号右边，有$k$个参变量的式子形如：$$(-1)^{k}\sum_{i_k}\mid A_{i_1}\cap A_{i_2}\cap\cdots A_{i_k}\mid;\quad (i_1<i_2<\cdots<i_k)$$
$i_k$的意义是这$k$在原位的排列个数，其值为$(n-k)!$，有$k$个参变量的式子有${n \choose k}$,等价于$${n\choose k}(-1)^k(n-k)!=(-1)^k\frac{n!}{k!}$$
即$$D_n=\mid\bar{A_1}\cap\bar{A_2}\cap\cdots\cap\bar{A_n}\mid=\sum_{k=0}^n(-1)^k{n\choose k}(n-k)!=\sum_{k=0}^n (-1)^k\frac{n!}{k!}$$
即$$D_n=n!\biggl(1-\frac 1{1!}+\frac 1{2!}-\frac 1{3!}+\cdots+(-1)^n\frac 1{n!}\biggr)$$

另外错位排列数还有递推的求法:
考察$n≥3$时$\left\{1,2,\cdots,n\right\}$的错位排列。把数$n$单独拿出来看，先把$n$放在第$n$位
设$P$是$\left\{1,2,\cdots,n−1\right\}$的一个排列

1). 如果P是错位排列，把其中任意一个数与$n$交换仍然是一个错位排列，这样的情形可以得到 
$(n−1)D_{n−1}$个$\left\{1,2,\cdots,n\right\}$的错位排列。
2). 如果P不是错位排列，并且只存在一个位置不符合要求，即只存在一个：满足$P_i=i$则将$i$与$n$交换后可得到一个错位排列。这里可以得到 $(n−1)D_{n−2}$个$\left\{1,2,\cdots,n\right\}$的错位排列
3). 其他情形都不能得到错位排列。
综合以上分析得到递推关系：$$D_n=(n−1)(D_{n−1}+D_{n−2}),D_1=0,D_2=1$$
## 特殊计数序列
### 基本概念
1. $Catalan$序列即序列$$C_0,C_1,C_2,\cdots,C_n,\cdots$$其中$$C_n=\frac{1}{n+1}{2n\choose n}\quad (n=1,2,3,\cdots)$$为第$n$个数$Catalan$数

2. 第一类 $Stirling$ 数$s(p,k)$是将$p$个有区别的球排成$k$个非空的圆排列的方案数。其中任一方案可表为: 将$p$个球分成非空的$k$份,再把每份中的球排成一个圆,$n$个球的圆排列数为$(n-1)!$
3. 第二类 $Stirling$ 数$S(p,k)$是将$p$个有区别的球放到$k$个相同的盒子中,要求没有空的方案总数
### 性质
1. $n$个$+1$和$n$个$-1$构成的$2n$项$$a_1,a_2,\cdots,a_{2n}$$其部分和满足非负性质，即$$a_1+a_2+\cdots+a_k\ge 0\quad (k=1,2,⋯,2n)$$此数列的个数等于第$n$个$Catalan$数
2. $n$对括号构成的合法的括号序列的个数等于第$n$个$Catalan$数
3. $2n$个人要买票价为五元的电影票，每人只买一张，但是售票员没有钱找零。其中，$n$个人持有五元，另外$n$个人持有十元，问在不发生找零困难的情况下，有多少种排队方式? 其解等于第$n$个$Catalan$数
4. 含$n+1$个叶子节点的二叉树个数等于第$n$个$Catalan$数。此处所指的二叉树要求,非叶子节点都有2个儿子 对含n+1个叶子节点的二叉树,考察其左右子树的叶子节点个数,由此引出$C_n$的递推表达式$$C_n=\sum_{i=0}^{n−1}C_iC_{n−1-i}$$
5. 通过不相交于内部的对角线把凸$n+2$边形拆分成若干个三角形，不同的拆分数等于第$n$个$Catalan$数
6. $s(p,k)$是将$p$个有区别的球排成$k$个非空的圆排列的方案数。
	1. $s(p,0)=0\quad (p≥1)$
	2. $s(p,p)=1\quad (p≥1)$
	3. $1\le k\le p-1$假设前$p-1$个球都已放好,考察第$p$个球:
		a. 单独放在一个盒子里。因为盒子是无区别的,1个球的圆排列只有1种,这种情形的方案数为$s(p-1,k-1)$
		b. 放在一个已有球的盒子里，即插入一个非空的圆中。每个圆定义顺时针方向为正方向。考虑第$p$个球在顺时针方向遇到的第一个球是哪个球，这个球有$p-1$种选择。所以这种情形的方案数为$(p-1)s(p-1,k)$
		综合以上分析,得到第一类斯特林数的递推式$$S(p,k)=(p-1)s(p-1,k)+s(p-1,k-1)$$
7. $S(p,k)$是将$p$个有区别的球放到$k$个相同的盒子中，要求没有空盒的方案总数。
	1. $S(p,0)=0\quad (p≥1)$
	2. $S(p,p)=1\quad (p≥1)$
	3. $S(p,1)=1\quad (p≥1)$
	4. $1\le k\le p-1$假设前$p-1$个球都已放好，考察第$p$个球：
		a. 单独放在一个盒子里。因为盒子是无区别的，这种情形的方案数为$S(p-1，k-1)$
		b. 放在一个已有球的盒子里。因为球是有区别的，所以与第$p$个球共盒子的球是有区别的，需要选一个盒子放入第$p$个球。因此这种情形的方案数为$kS(p-1，k)$
		综合以上分析，得到第二类斯特林数的递推式$$S(p,k)=S(p-1,k-1)+kS(p-1,k)$$
## $P\acute orlya$计数定理
### 基本概念
- 有这样一类着色问题，一些表面不同的着色在某种意义上是相同的，需要对在这种意义下本质不同的着色进行计数。例如可以用黑白两种颜色对正五角形的顶点进行着色，则一共有$2^5=32$种不同的着色。但是如果把在旋转和(空间中)翻转意义下相同的着色只记作一种，则一共只有8种着色方案。
- 下面利用群论对此类问题进行抽象化的描述。假设$c$是集合$X$上的一种着色。例如$X$是正方形的顶点集合，每个顶点可以染成红色$(R)$或蓝色$(B)$，则$(R，B，R，B)$就是对正方形的一种着色，表示把正方形的顶点依次染成红色、蓝色、红色和蓝色。如果对$X$中的元素按正整数编号，则可以用$c(1)，c(2)，\cdots，c(n)$来表示对应元素的着色。
- 设$f$是一个$X$上的一个置换：$$ ⁤f=( \begin{matrix} 1 & 2 & \cdots & n-1 & \pi \\ i_{1} & i_{2} & \cdots &i_{n}-1&i_{n}\end{matrix}) $$⁤ 定义置换对着色的作用·为将着色按置换变换后产生的着色，即 ⁤$(f \circ c)(i_{k})=c(k)⁤$仍然以正方形为例，假设着色$c$为$(R，B，R，B)$，置换$f$为$(1，2，3)(4)$，则$f\circ c$为$(R，R，B，B)$。注意这里使用了置换的循环节表示法。
- 一般地，对于置换群$G$和着色集合$C$来说，按照以上方式定义群作用$\circ$，只要群中的置换对着色集合$C$作用满足封闭性，即对于任意$q\in G$，$c\in C$满足$g\circ c\in C$，则显然$1_G\circ c=c$和$(gh)\circ c=g\circ (h\circ c)$，其中$g$和$h$为置换群$G$中的任意两个置换，$c$为$C$中的一个着色。
- 可以从群作用中诱导出一个着色的等价关系$～$。着色集$C$中的两个着色$c_1$和$c_2$等价，即$c_1~c_2$，当且仅当置换群$G$中存在置换$g$，满足$g\circ c_{1}=c_{2}$
- 性质
	- Burnside引理
	- 设$G$是集合$X$上的一个置换群，$C$为$X$上的一个着色集合，$G$对$C$的作用满足封闭性，则不等价的着色数为：$$⁤B= \frac{1}{\mid G}\sum_{g\in G}\mid S(g)\mid$$其中$S(g)$为$C$中对置换$g$保持不变的着色集合。
	- $P\acute orlya$计数定理
	- 设$G$是集合$X$上的一个置换群，$X$中每个元素可以被染成$k$种颜色，则不等价的着色数为：$$P=\frac{1}{\mid G\mid}\sum_{g\in G}k^{nc(g)}$$其中$nc(g)$为置换$g$中循环节的个数